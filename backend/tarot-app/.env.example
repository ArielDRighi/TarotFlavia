# =============================================================================
# TAROT - DOCKER ENVIRONMENT CONFIGURATION
# =============================================================================
# This file contains all environment variables needed for Docker services.
# Copy this file to .env and update the values according to your setup.
#
# IMPORTANT: Never commit your .env file to version control!
# =============================================================================

# -----------------------------------------------------------------------------
# PostgreSQL Database Configuration (Development)
# -----------------------------------------------------------------------------
# Database connection settings for Tarot PostgreSQL container

# Port exposed on your host machine (avoid conflicts with other PostgreSQL instances)
# Default: 5435 (other projects use 5432, 5433, 5434)
TAROT_DB_PORT=5435

# PostgreSQL superuser credentials
TAROT_DB_USER=tarot_user
TAROT_DB_PASSWORD=tarot_password_2024

# Database name
TAROT_DB_NAME=tarot_db

# PostgreSQL version (referenced in docker-compose.yml)
TAROT_POSTGRES_VERSION=16-alpine

# -----------------------------------------------------------------------------
# pgAdmin Configuration (Optional)
# -----------------------------------------------------------------------------
# Web interface for PostgreSQL database management
# Access at: http://localhost:5050 (or your configured port)

# Port exposed on your host machine for pgAdmin web interface
TAROT_PGADMIN_PORT=5050

# pgAdmin login credentials
TAROT_PGADMIN_EMAIL=admin@tarot.local
TAROT_PGADMIN_PASSWORD=change_me_to_secure_password

# -----------------------------------------------------------------------------
# NestJS Backend Configuration (for connecting to Docker PostgreSQL)
# -----------------------------------------------------------------------------
# These variables should be used in your backend .env file

# Database connection string
TAROT_DATABASE_URL=postgresql://tarot_user:tarot_password_2024@localhost:5435/tarot_db

# Individual database connection parameters (for TypeORM)
TAROT_DB_HOST=localhost
TAROT_DB_PORT_INTERNAL=5435
TAROT_DB_USERNAME=tarot_user
TAROT_DB_PASSWORD_VALUE=tarot_password_2024
TAROT_DB_DATABASE=tarot_db

# TypeORM specific settings (backward compatibility)
POSTGRES_HOST=localhost
POSTGRES_PORT=5435
POSTGRES_USER=tarot_user
POSTGRES_PASSWORD=tarot_password_2024
POSTGRES_DB=tarot_db

# TypeORM specific settings
TAROT_DB_SYNCHRONIZE=false
TAROT_DB_LOGGING=true

# -----------------------------------------------------------------------------
# Testing Database Configuration (E2E Tests)
# -----------------------------------------------------------------------------
# Dedicated database for E2E tests (isolated from development)

# Port exposed on your host machine for E2E test database
TAROT_E2E_DB_PORT=5436

# PostgreSQL credentials for E2E tests
TAROT_E2E_DB_USER=tarot_e2e_user
TAROT_E2E_DB_PASSWORD=tarot_e2e_password_2024

# E2E test database name
TAROT_E2E_DB_NAME=tarot_e2e

# E2E test database host
TAROT_E2E_DB_HOST=localhost

# TypeORM specific settings for E2E
TAROT_E2E_DB_SYNCHRONIZE=false
TAROT_E2E_DB_LOGGING=false

# -----------------------------------------------------------------------------
# JWT Authentication Configuration (REQUIRED)
# -----------------------------------------------------------------------------
# JSON Web Token settings for user authentication

# JWT secret key - MUST be at least 32 characters for security
# Generate a secure random string with: openssl rand -base64 32
# Or use: node -e "console.log(require('crypto').randomBytes(32).toString('base64'))"
JWT_SECRET=your_jwt_secret_min_32_characters_use_openssl_rand_base64_32

# JWT token expiration time (Examples: '15m', '1h', '7d', '30d')
JWT_EXPIRES_IN=7d

# -----------------------------------------------------------------------------
# AI Provider Configuration
# -----------------------------------------------------------------------------
# Multiple AI providers supported with cost-optimized strategy
# See docs/AI_PROVIDERS.md for detailed setup guide and cost comparison

# === GROQ (PRIMARY - REQUIRED - FREE) ===
# Groq provides ultra-fast inference with Llama models
# Get your free API key at: https://console.groq.com
# Limits: 14,400 requests/day, 30 requests/min (FREE TIER)
GROQ_API_KEY=gsk_your_groq_api_key_here
GROQ_MODEL=llama-3.3-70b-versatile

# === DEEPSEEK (GROWTH - OPTIONAL - LOW COST) ===
# DeepSeek offers cost-effective scaling (~$0.80 per 1000 interpretations)
# Get your API key at: https://platform.deepseek.com
# Uncomment when scaling beyond free tier
# DEEPSEEK_API_KEY=sk_your_deepseek_api_key_here
# DEEPSEEK_MODEL=deepseek-chat

# === OPENAI (FALLBACK/PREMIUM - OPTIONAL) ===
# OpenAI provides highest quality but higher cost (~$4.50 per 1000 interpretations)
# Get your API key at: https://platform.openai.com/api-keys
# Use for fallback or premium features only
# OPENAI_API_KEY=sk-your_openai_api_key_here
# OPENAI_MODEL=gpt-4o-mini

# -----------------------------------------------------------------------------
# Application Configuration (OPTIONAL - Has Defaults)
# -----------------------------------------------------------------------------

# Node environment: 'development', 'production', or 'test' (Default: development)
NODE_ENV=development

# Application server port (Default: 3000)
PORT=3000

# -----------------------------------------------------------------------------
# CORS Configuration (OPTIONAL)
# -----------------------------------------------------------------------------

# Allowed origins - comma-separated list of URLs (Default: http://localhost:3000)
# Production example: https://app.tarotflavia.com,https://www.tarotflavia.com
CORS_ORIGINS=http://localhost:3000

# -----------------------------------------------------------------------------
# Rate Limiting Configuration (OPTIONAL - Has Defaults)
# -----------------------------------------------------------------------------

# Time window in seconds (Default: 60)
RATE_LIMIT_TTL=60

# Maximum requests per time window (Default: 100)
RATE_LIMIT_MAX=100

# -----------------------------------------------------------------------------
# Email Configuration (OPTIONAL)
# -----------------------------------------------------------------------------
# SMTP settings for sending emails (shared readings, welcome, password reset, etc.)
# If not configured, email functionality will be disabled (app will still work)
# For development/testing, use Mailtrap.io (free service)

# SMTP server hostname (e.g., smtp.gmail.com, smtp.mailtrap.io, smtp-mail.outlook.com)
# SMTP_HOST=smtp.mailtrap.io

# SMTP server port (587 for TLS, 465 for SSL, 25 for unencrypted)
# SMTP_PORT=587

# SMTP authentication username
# SMTP_USER=your_smtp_username

# SMTP authentication password
# SMTP_PASS=your_smtp_password

# Email address used as sender (From: field)
# EMAIL_FROM=noreply@tarotflavia.com

# Frontend URL for password reset links (Default: http://localhost:3000)
# FRONTEND_URL=http://localhost:3000

# -----------------------------------------------------------------------------
# Logging Configuration (OPTIONAL - Has Defaults)
# -----------------------------------------------------------------------------
# Structured logging with Winston

# Log level: 'error', 'warn', 'info', 'http', 'verbose', 'debug' (Default: info)
LOG_LEVEL=info

# Log files directory (Default: ./logs)
LOG_DIR=./logs

# Log file retention period (Default: 14d)
# Examples: '7d', '14d', '30d', '60d'
LOG_MAX_FILES=14d

# Maximum log file size (Default: 20m)
# Examples: '10m', '20m', '50m', '100m'
LOG_MAX_SIZE=20m

# -----------------------------------------------------------------------------
# Development vs Production
# -----------------------------------------------------------------------------
# NODE_ENV=development  # Use this for local development with Docker
# NODE_ENV=production   # Use this for production deployments

# -----------------------------------------------------------------------------
# Notes & Security Best Practices
# -----------------------------------------------------------------------------
# 1. Update passwords with secure values before deploying to production
# 2. Port 5435 is used for development DB, 5436 for E2E tests to avoid conflicts with:
#    - Port 5432: ecommerce-postgres
#    - Port 5433: microservices-postgres
#    - Port 5434: go-api-postgres
# 3. To start only PostgreSQL (dev): docker-compose up -d tarot-postgres
# 4. To start E2E test database: docker-compose up -d tarot-postgres-e2e
# 5. To start with pgAdmin: docker-compose --profile tools up -d
# 6. All container names, volumes, and networks have 'tarot' prefix
#    to maintain consistency with the tarot-app container
#
# VALIDATION:
# - The application will NOT start if required variables are missing or invalid
# - Error messages will clearly indicate which variables need to be corrected
# - All variables are validated on application startup
# - See src/config/env.validation.ts for validation rules
#
# SECURITY:
# - Use strong, unique passwords for production environments
# - Regenerate JWT_SECRET for each environment (min 32 characters)
# - Never expose your .env file publicly
# - Store production secrets in a secure vault (AWS Secrets Manager, etc.)
# - Use different credentials for development and production
#
# FOR MORE INFORMATION:
# - See docs/MIGRATIONS.md for database migration setup
# - See README-DOCKER.md for Docker-specific configuration
# - See README.md for general application setup

